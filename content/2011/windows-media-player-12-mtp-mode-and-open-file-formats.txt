---
title: Windows Media Player 12, MTP mode, and open file formats
author: Michaelhughes
date: 13.05.2011
filter: [rst, ]
tags: [Windows]
---

I like Windows Media Player.

There I said it.

I have used MuiscMatch, later I became a foobar2000 fan, however now WMP 12 has an excellent user interface, a built-in DLNA service, and good device sync capabilities. The problem with WMP is that is doesn't have the same codec flexibility as foobar. My music library is a mixture of mp3, wma, wma lossess, ogg vorbis, and flac files; my preferred formats are flac for CD rips and high bitrate mp3 for legally downloaded music.

The solution to playing music encoded using vorbis, flac, etc is two fold:

#. Get the codecs from the source,\ `xiph.org <http://xiph.org/dshow/>`_ supplies the necessary directshow filters for WMP to decode and play FOSS formats such as flac and vorbis.
#. Get the\ `WMP Tag Plus plugin <http://bmproductions.fixnum.org/index.htm?http://bmproductions.fixnum.org/wmptagplus/>`_ which enables WMP to understand (read/write) the ogg tag format.


With the two above additions WMP can recognize, play, and organize most common music codecs, but what about syncing to a device?

I have a Sansa Clip+ which conveniently supports flac, ogg vorbis, wma, and mp3 encoded files. Using WMP I built playlists to sync to my player, but after sync I found that the flac and ogg files always failed to sync. The vague error message indicates that the device might not support the files formats, strange since the Clip+ should support those file formats.

The Clip+ can connect to a computer using either of two protocols MSC or MTP. MTP, media tunnel protocol is newer and preferred, it presents the player as a logical device to a computer, whereas MSC media storage class presents the MP3 player as a dumb usb drive.

What does this have to do with WMP12? When placed in MTP mode WMP will attempt to determine what formats/bitrates a connected device supports and transcode any unsupported formats in the background when transferring files to the device. Normally, WMP12 transcoding works beautifully, but when dealing with FOSS codecs like vorbis it chokes, throwing an error. The simplest solution is to switch the connected device to MSC mode where WMP12 makes no attempt to transcode files, it is then up to the user to ensure that the device supports all of the codecs in use. In my case my Clip+ supports every codec used in my library so it works perfectly.
